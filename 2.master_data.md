# Master Data Design & Schema

## 2. Master Data

### 2.1 ข้อมูลหลัก (Core Master)

| Entity | Description | Type | Fields / Properties |
| :--- | :--- | :--- | :--- |
| **Employee** | ข้อมูลพนักงาน | Table | `id` (PK), `employeeId` (Unique), `prefix`, `firstName`, `lastName`, `nickname`, `idCard` (Unique), `birthDate`, `gender`, `maritalStatus`, `address`, `mobile`, `lineId`, `joinDate`, `probationDate`, `resignDate`, `status` (Enum), `isDeleted` |
| **Candidate** | ข้อมูลผู้มาสมัครงาน / สัมภาษณ์งาน | Table | `id` (PK), `firstName`, `lastName`, `email`, `mobile`, `positionAppliedId` (FK), `expectedSalary`, `resumeUrl`, `interviewDate`, `interviewerId` (FK), `status` (Enum: PENDING, INTERVIEWING, HIRED, REJECTED), `notes` |
| **Company** | ข้อมูลบริษัท / องค์กร | Table | `id` (PK), `code` (Unique), `name`, `address`, `phone`, `taxId`, `parentId` (Self-Ref for Subsidiaries) |
| **Department** | ข้อมูลแผนก | Table | `id` (PK), `code`, `name`, `companyId` (FK), `parentId` (Self-Ref for Hierarchy) |
| **Position** | ข้อมูลตำแหน่ง | Table | `id` (PK), `title`, `level` (Int), `departmentId` (FK), `jobDescriptionId` (FK) |
| **JobDescription** | ข้อมูลงาน (ผูกกับตำแหน่ง) | Table | `id` (PK), `title`, `description`, `requirements`, `responsibilities`, `kpiIds` (Array or Relation) |
| **EmployeeGroup** | ข้อมูลกลุ่มพนักงาน | Table | `id` (PK), `name` (e.g. Back Office, Field), `description` |
| **EmployeeType** | ข้อมูลประเภทพนักงาน | Table | `id` (PK), `name` (e.g. Monthly, Daily, Contract), `paymentCycle` |
| **LeaveType** | ข้อมูลประเภทการลา / หยุด | Table | `id` (PK), `name` (e.g. Sick, Vacation), `quotaPerYear`, `requiresCertificate` (Bool), `isPaid` (Bool) |
| **OtType** | ข้อมูลประเภท OT | Table | `id` (PK), `name` (e.g. 1.5x, 2.0x), `rateMultiplier`, `condition` |
| **User** | ข้อมูลผู้ใช้งานระบบ | Table | `id` (PK), `username` (Unique), `passwordHash`, `role` (Enum), `employeeId` (FK), `isActive` |
| **Role** | ข้อมูลสิทธิ์การใช้งาน | Enum / Table | `SUPER_ADMIN`, `ADMIN`, `HR`, `MANAGER`, `EMPLOYEE` (Currently Enum, can be Table for dynamic permissions) |
| **ShiftSchedule** | ตารางกะทำงาน | Table | `id` (PK), `name`, `startTime`, `endTime`, `breakStartTime`, `breakEndTime`, `workingDays` (Array) |
| **CompanyHoliday** | วันหยุดบริษัท | Table | `id` (PK), `date`, `name`, `isRecurring` (Bool), `companyId` (FK) |

### 2.2 Schema Definition (Prisma)

```prisma
// Enums
enum CandidateStatus {
  PENDING
  INTERVIEWING
  OFFERED
  HIRED
  REJECTED
}

// Core Models

model Candidate {
  id              String          @id @default(cuid())
  firstName       String
  lastName        String
  email           String
  mobile          String
  
  positionId      String
  position        Position        @relation(fields: [positionId], references: [id])
  
  expectedSalary  Decimal?
  resumeUrl       String?
  
  interviewDate   DateTime?
  interviewerId   String?
  interviewer     Employee?       @relation("Interviewer", fields: [interviewerId], references: [id])
  
  status          CandidateStatus @default(PENDING)
  notes           String?
  
  createdAt       DateTime        @default(now())
  updatedAt       DateTime        @updatedAt
}

model JobDescription {
  id               String    @id @default(cuid())
  title            String
  description      String    @db.Text
  requirements     String?   @db.Text
  responsibilities String?   @db.Text
  
  positions        Position[]

  createdAt        DateTime  @default(now())
  updatedAt        DateTime  @updatedAt
}

model EmployeeGroup {
  id          String     @id @default(cuid())
  name        String     @unique
  description String?
  
  employees   Employee[]
  
  createdAt   DateTime   @default(now())
  updatedAt   DateTime   @updatedAt
}

model EmployeeType {
  id           String     @id @default(cuid())
  name         String     @unique // Monthly, Daily, Contract
  
  employees    Employee[]

  createdAt    DateTime   @default(now())
  updatedAt    DateTime   @updatedAt
}

model LeaveTypeConfig { // Renamed from LeaveType to avoid conflict with Enum if kept, or replace Enum
  id                  String   @id @default(cuid())
  name                String   @unique
  quotaPerYear        Int      @default(30)
  requiresCertificate Boolean  @default(false)
  isPaid              Boolean  @default(true)
  
  leaveRequests       LeaveRequest[]

  createdAt           DateTime @default(now())
  updatedAt           DateTime @updatedAt
}

model OtType {
  id             String   @id @default(cuid())
  name           String   @unique // OT 1.5, OT 3.0
  rateMultiplier Decimal  @default(1.5)
  
  overtimeRecords OvertimeRecord[] // Need to create this model

  createdAt      DateTime @default(now())
  updatedAt      DateTime @updatedAt
}

model ShiftSchedule {
  id             String   @id @default(cuid())
  name           String   @unique // e.g. "Normal 08:00-17:00"
  startTime      String   // "08:00"
  endTime        String   // "17:00"
  
  employees      Employee[] // Assigned shift

  createdAt      DateTime @default(now())
  updatedAt      DateTime @updatedAt
}

model CompanyHoliday {
  id          String   @id @default(cuid())
  date        DateTime @db.Date
  name        String
  isRecurring Boolean  @default(true)
  
  companyId   String?
  company     Company? @relation(fields: [companyId], references: [id])

  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt
}

// Extension to Existing Models

// Add to Employee model:
// employeeGroupId String?
// employeeGroup   EmployeeGroup? @relation(fields: [employeeGroupId], references: [id])
// employeeTypeId  String?
// employeeType    EmployeeType? @relation(fields: [employeeTypeId], references: [id])
// shiftScheduleId String?
// shiftSchedule   ShiftSchedule? @relation(fields: [shiftScheduleId], references: [id])

// Add to Position model:
// jobDescriptionId String?
// jobDescription   JobDescription? @relation(fields: [jobDescriptionId], references: [id])

// Add to LeaveRequest model:
// leaveTypeId     String
// leaveTypeConfig LeaveTypeConfig @relation(fields: [leaveTypeId], references: [id])
```

